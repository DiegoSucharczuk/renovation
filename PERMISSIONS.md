# ××¢×¨×›×ª × ×™×”×•×œ ×”×¨×©××•×ª - Renovation App

## ×ª×™××•×¨ ×”××¢×¨×›×ª

××¢×¨×›×ª ×”×¨×©××•×ª ××œ××” ×œ× ×™×”×•×œ ×’×™×©×” ×•×ª×¤×§×™×“×™× ×‘×¤×¨×•×™×§×˜ ×©×™×¤×•×¥, ×›×•×œ×œ ×”×¡×ª×¨×” ××•×˜×•××˜×™×ª ×©×œ × ×ª×•× ×™× ×¤×™× × ×¡×™×™× ××’×•×¨××™× ×œ× ××•×¨×©×™×.

## ×ª×¤×§×™×“×™× ×•×”×¨×©××•×ª

### ğŸ”´ ×‘×¢×œ×™× (OWNER)
- **×’×™×©×” ××œ××”** ×œ×›×œ ×”×¤×¨×•×™×§×˜
- × ×™×”×•×œ ×›×œ ×”××©×ª××©×™× ×•×”×ª×¤×§×™×“×™×
- ×’×™×©×” ×œ×›×œ ×”× ×ª×•× ×™× ×”×¤×™× × ×¡×™×™×
- ××—×™×§×ª ×”×¤×¨×•×™×§×˜

### ğŸ”µ ×× ×”×œ (ADMIN)
- ×›××¢×˜ ×›×œ ×”×”×¨×©××•×ª ×©×œ ×”×‘×¢×œ×™×
- × ×™×”×•×œ ××©×ª××©×™× ×•×”×¨×©××•×ª
- ×’×™×©×” ××œ××” ×œ× ×ª×•× ×™× ×¤×™× × ×¡×™×™×
- ×¢×¨×™×›×ª ×›×œ ×”××™×“×¢ ×‘×¤×¨×•×™×§×˜

### ğŸŸ¢ ×‘×Ÿ ××©×¤×—×” (FAMILY)
- **×¦×¤×™×™×”** ×‘×ª×§×¦×™×‘ ×•×‘×ª×©×œ×•××™×
- ×¢×¨×™×›×ª ××©×™××•×ª ×•×—×“×¨×™×
- **×œ×œ×** ××¤×©×¨×•×ª ×¢×¨×™×›×ª ×ª×§×¦×™×‘ ××• ×ª×©×œ×•××™×
- **×œ×œ×** ××¤×©×¨×•×ª × ×™×”×•×œ ××©×ª××©×™×

### ğŸŸ¡ ×§×‘×œ×Ÿ (CONTRACTOR)
- ×¢×¨×™×›×ª ××©×™××•×ª ×©×§×©×•×¨×•×ª ××œ×™×•
- **×œ×œ× ×’×™×©×”** ×œ× ×ª×•× ×™× ×¤×™× × ×¡×™×™×
- **×œ×œ× ×’×™×©×”** ×œ×“×£ ×ª×©×œ×•××™×
- **×œ×œ× ×’×™×©×”** ×œ×¢×¨×™×›×ª ×—×“×¨×™×

### ğŸŸ£ ××¢×¦×‘ (DESIGNER)
- ×¢×¨×™×›×ª ××©×™××•×ª ×©×§×©×•×¨×•×ª ××œ×™×•
- **×œ×œ× ×’×™×©×”** ×œ× ×ª×•× ×™× ×¤×™× × ×¡×™×™×  
- **×œ×œ× ×’×™×©×”** ×œ×“×£ ×ª×©×œ×•××™×
- **×œ×œ× ×’×™×©×”** ×œ×¢×¨×™×›×ª ×—×“×¨×™×

### âšª ×¦×¤×™×™×” ×‘×œ×‘×“ (VIEW_ONLY)
- ×¦×¤×™×™×” ×‘×›×œ ×”××™×“×¢ **×œ×œ× × ×ª×•× ×™× ×¤×™× × ×¡×™×™×**
- **××™×Ÿ** ××¤×©×¨×•×ª ×¢×¨×™×›×” ×›×œ×œ

## ××˜×¨×™×¦×ª ×”×¨×©××•×ª ××¤×•×¨×˜×ª

| ×”×¨×©××” | ×‘×¢×œ×™× | ×× ×”×œ | ××©×¤×—×” | ×§×‘×œ×Ÿ | ××¢×¦×‘ | ×¦×¤×™×™×” |
|-------|-------|------|-------|------|------|-------|
| ×¦×¤×™×™×” ×‘×ª×§×¦×™×‘ | âœ… | âœ… | âœ… | âŒ | âŒ | âŒ |
| ×¢×¨×™×›×ª ×ª×§×¦×™×‘ | âœ… | âœ… | âŒ | âŒ | âŒ | âŒ |
| ×¦×¤×™×™×” ×‘×ª×©×œ×•××™× | âœ… | âœ… | âœ… | âŒ | âŒ | âŒ |
| ×¢×¨×™×›×ª ×ª×©×œ×•××™× | âœ… | âœ… | âŒ | âŒ | âŒ | âŒ |
| × ×™×”×•×œ ××©×ª××©×™× | âœ… | âœ… | âŒ | âŒ | âŒ | âŒ |
| ×¢×¨×™×›×ª ×¤×¨×•×™×§×˜ | âœ… | âœ… | âŒ | âŒ | âŒ | âŒ |
| ×¢×¨×™×›×ª ××©×™××•×ª | âœ… | âœ… | âœ… | âœ… | âœ… | âŒ |
| ×¢×¨×™×›×ª ×—×“×¨×™× | âœ… | âœ… | âœ… | âŒ | âŒ | âŒ |

## ××™×š ×œ×”×©×ª××©

### ×”×•×¡×¤×ª ××©×ª××© ×œ×¤×¨×•×™×§×˜

1. ×”×™×›× ×¡ ×œ×“×£ **×”×’×“×¨×•×ª ×¤×¨×•×™×§×˜** (×œ×—×¦×Ÿ ×”×”×’×“×¨×•×ª ×‘×ª×¤×¨×™×˜ ×”×¦×“)
2. ×œ×—×¥ ×¢×œ **"×”×•×¡×£ ××©×ª××©"**
3. ×”×–×Ÿ ××ª ×›×ª×•×‘×ª ×”××™××™×™×œ ×©×œ ×”××©×ª××©
4. ×‘×—×¨ ×ª×¤×§×™×“ ××”×¨×©×™××”
5. ×œ×—×¥ **"×”×•×¡×£"**

> âš ï¸ **×©×™× ×œ×‘**: ×”××©×ª××© ×—×™×™×‘ ×œ×”×™×¨×©× ×§×•×“× ×œ××¢×¨×›×ª

### ×©×™× ×•×™ ×ª×¤×§×™×“ ××©×ª××©

1. ×‘×˜×‘×œ×ª ×”××©×ª××©×™×, ×œ×—×¥ ×¢×œ ×›×¤×ª×•×¨ ×”×¢×¨×™×›×” âœï¸
2. ×‘×—×¨ ×ª×¤×§×™×“ ×—×“×©
3. ×œ×—×¥ **"×©××•×¨"**

### ×”×¡×¨×ª ××©×ª××© ××”×¤×¨×•×™×§×˜

1. ×‘×˜×‘×œ×ª ×”××©×ª××©×™×, ×œ×—×¥ ×¢×œ ×›×¤×ª×•×¨ ×”××—×™×§×” ğŸ—‘ï¸
2. ××©×¨ ××ª ×”××—×™×§×”

> âš ï¸ **×œ× × ×™×ª×Ÿ** ×œ××—×•×§ ××• ×œ×©× ×•×ª ××ª ×ª×¤×§×™×“ ×”×‘×¢×œ×™×

## ×¨×›×™×‘×™ ×”××¢×¨×›×ª

### 1. Hook - `useProjectRole`
```typescript
const { role, permissions, isOwner, loading } = useProjectRole(projectId, userId);
```

××—×–×™×¨:
- `role` - ×”×ª×¤×§×™×“ ×©×œ ×”××©×ª××©
- `permissions` - ××•×‘×™×™×§×˜ ×¢× ×›×œ ×”×”×¨×©××•×ª
- `isOwner` - ×”×× ×”××©×ª××© ×”×•× ×”×‘×¢×œ×™×
- `loading` - ×¡×˜×˜×•×¡ ×˜×¢×™× ×”

### 2. ×¨×›×™×‘ - `<AccessDenied />`
××¦×™×’ ×”×•×“×¢×ª "××™×Ÿ ×”×¨×©××”" ×›××©×¨ ××©×ª××© ×× ×¡×” ×œ×’×©×ª ×œ×“×£ ×œ×œ× ×”×¨×©××•×ª ××ª××™××•×ª.

### 3. ×“×£ ×”×’×“×¨×•×ª - `/dashboard/[projectId]/settings`
- ×˜×‘×œ×ª ××©×ª××©×™× ×¢× ×ª×¤×§×™×“×™×
- ×”×•×¡×¤×”, ×¢×¨×™×›×” ×•×”×¡×¨×ª ××©×ª××©×™×
- ×˜×‘×œ×ª ×”×¨×©××•×ª ××¤×•×¨×˜×ª
- ×–××™×Ÿ ×¨×§ ×œ×‘×¢×œ×™× ×•×× ×”×œ×™×

### 4. ×”×’× ×” ××•×˜×•××˜×™×ª
×›×œ ×”×“×¤×™× ××•×’× ×™× ××•×˜×•××˜×™×ª:
- **Dashboard** - ××¡×ª×™×¨ × ×ª×•× ×™× ×¤×™× × ×¡×™×™×
- **Payments** - × ×’×™×© ×¨×§ ×œ××•×¨×©×™×
- **Vendors** - × ×ª×•× ×™× ×¤×™× × ×¡×™×™× ××•×¡×ª×¨×™×
- **Settings** - × ×’×™×© ×¨×§ ×œ×‘×¢×œ×™× ×•×× ×”×œ×™×

## ×“×•×’×××•×ª ×©×™××•×© ×‘×§×•×“

### ×‘×“×™×§×ª ×”×¨×©××” ×œ×¤× ×™ ×”×¦×’×ª ×ª×•×›×Ÿ:

```typescript
{permissions?.canViewBudget && (
  <Box>
    {/* ×ª×•×›×Ÿ ×¤×™× × ×¡×™ */}
  </Box>
)}
```

### ×”×¡×ª×¨×ª ×›×¤×ª×•×¨ ×¢×¨×™×›×”:

```typescript
<Button 
  disabled={!permissions?.canEditProject}
  onClick={handleEdit}
>
  ×¢×¨×•×š
</Button>
```

### ×‘×“×™×§×ª ×”×¨×©××” ×‘×œ×™×™××•×˜:

```typescript
const menuItems = [
  { text: '×ª×©×œ×•××™×', path: '/payments', hidden: !permissions?.canViewPayments },
  { text: '×”×’×“×¨×•×ª', path: '/settings', hidden: !permissions?.canManageUsers },
];
```

## ××‘×˜×—×”

- âœ… ×‘×“×™×§×ª ×”×¨×©××•×ª ×‘×¦×“ ×œ×§×•×— (Client-side)
- âœ… ×”×¡×ª×¨×” ××•×˜×•××˜×™×ª ×©×œ × ×ª×•× ×™× ×¨×’×™×©×™×
- âœ… ×—×¡×™××ª ×’×™×©×” ×œ×“×¤×™× ×œ× ××•×¨×©×™×
- âš ï¸ **×—×©×•×‘**: ×™×© ×œ×”×•×¡×™×£ ×‘×“×™×§×•×ª ××‘×˜×—×” ×‘×¦×“ ×”×©×¨×ª (Firebase Security Rules)

## Firebase Security Rules (××•××œ×¥)

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // ×¨×§ ×‘×¢×œ×™× ×•×× ×”×œ×™× ×™×›×•×œ×™× ×œ× ×”×œ ××©×ª××©×™×
    match /projectUsers/{userId} {
      allow read: if request.auth != null;
      allow create, update, delete: if isOwnerOrAdmin(resource.data.projectId);
    }
    
    function isOwnerOrAdmin(projectId) {
      let project = get(/databases/$(database)/documents/projects/$(projectId));
      return request.auth.uid == project.data.ownerId || 
             exists(/databases/$(database)/documents/projectUsers/$(request.auth.uid)) &&
             get(/databases/$(database)/documents/projectUsers/$(request.auth.uid)).data.roleInProject in ['ADMIN'];
    }
  }
}
```

## ×ª×¨×•××” ×•×¤×™×ª×•×—

×›×“×™ ×œ×”×•×¡×™×£ ×”×¨×©××” ×—×“×©×”:

1. ×”×•×¡×£ ××ª ×”×”×¨×©××” ×œ-`RolePermissions` interface ×‘-`types/index.ts`
2. ×¢×“×›×Ÿ ××ª `getRolePermissions()` ×‘-`lib/permissions.ts`
3. ×”×©×ª××© ×‘×”×¨×©××” ×‘×§×•××¤×•× × ×˜×•×ª ×¢× `permissions?.yourNewPermission`

---

**× ×•×¦×¨ ×¢× â¤ï¸ ×œ× ×™×”×•×œ ×¤×¨×•×™×§×˜×™ ×©×™×¤×•×¥**
